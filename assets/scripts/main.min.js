const resultModal=document.querySelector(".result"),successIcon=document.getElementById("success"),failureIcon=document.getElementById("failure"),resultMessage=document.getElementById("result-message"),showResultModal=(a,b)=>{!0==a?(successIcon.style.display="block",failureIcon.style.display="none"):!1==a&&(successIcon.style.display="none",failureIcon.style.display="block"),resultMessage.textContent=b,resultModal.classList.add("show-result"),setTimeout(()=>{resultModal.classList.remove("show-result"),successIcon.style.display="none",failureIcon.style.display="none",resultMessage.textContent=""},2e3)},separateButton=document.querySelector(".scroll-to-top");document.addEventListener("scroll",()=>{const a=document.documentElement.scrollTop;1200<a?separateButton.style.opacity=1:(separateButton.style.display="flex",separateButton.style.opacity=0)}),separateButton.addEventListener("click",()=>{window.scrollTo(0,0)});const itemsContainer=document.querySelector(".modal__items"),singleItemContainer=document.querySelector(".single-product");function sendHttpRequest(a,b,c){return fetch(b,{method:a,body:JSON.stringify(c),headers:{"Content-Type":"application/json"}}).then(a=>200<=a.status&&300>a.status?a.json():a.json().then(a=>{throw showResultModal(!1,a),new Error("Server-side problem!")})).catch(a=>{throw showResultModal(!1,a),new Error("Something went wrong!")})}async function getProduct(a){try{const b=await sendHttpRequest("GET",`http://localhost/api/product/read.php?tn=${a}`);itemsContainer.innerHTML="";for(const c of b){const b=c.id,d=c["product-title"],e=c["product-price"],f=c["product-size"],g=c["product-description"],h=c["product-image-one"],i=c["product-image-two"],j=c["product-image-three"],k=c["product-image-four"],l={category:a,id:b,title:d,price:e,image:h,count:1},m=document.createElement("div");m.classList.add("modal__item"),m.style.backgroundImage=h;const n=document.createElement("div");n.classList.add("item__icons"),m.appendChild(n);const o=document.createElement("div");o.setAttribute("id","item-preview"),n.appendChild(o);const p=document.createElement("i");p.classList.add("fas","fa-search"),o.appendChild(p);const q=document.createElement("div");q.setAttribute("id","item-favorite"),n.appendChild(q),q.addEventListener("click",()=>{addToFavorite(l)});const r=document.createElement("i");r.classList.add("far","fa-heart"),q.appendChild(r);const s=document.createElement("div");s.setAttribute("id","item-card"),n.appendChild(s),s.addEventListener("click",()=>{addToChart(l)});const t=document.createElement("i");t.classList.add("fas","fa-shopping-cart"),s.appendChild(t),itemsContainer.appendChild(m),m.addEventListener("mouseenter",a=>{a.currentTarget.style.backgroundImage=j}),m.addEventListener("mouseout",a=>{a.currentTarget.style.backgroundImage=h}),o.addEventListener("click",()=>{setActiveProduct({category:a,id:b,title:d,price:e,image:h,count:1}),singleItemContainer.classList.add("single-product--open");const c=document.querySelector(".product__images--main"),l=document.querySelector(".thumbnail-image__one"),m=document.querySelector(".thumbnail-image__two"),n=document.querySelector(".thumbnail-image__three"),o=document.querySelector(".thumbnail-image__four"),p=document.querySelector(".product__info h2"),q=document.querySelector(".product__info h3"),r=document.querySelector(".product__info h4"),s=document.querySelector(".product__info p"),t=document.querySelector(".actions__amount");t.textContent="1";const u=document.querySelector(".actions__change--add"),v=document.querySelector(".actions__change--remove");u.addEventListener("click",()=>{let a=parseInt(t.textContent);a++,t.textContent=a}),v.addEventListener("click",()=>{let a=parseInt(t.textContent);a--,1>a&&(a=1),t.textContent=a}),c.style.backgroundImage=h,l.style.backgroundImage=h,m.style.backgroundImage=i,n.style.backgroundImage=j,o.style.backgroundImage=k,p.textContent=d,q.textContent=e,r.textContent=f,s.textContent=g;const w=document.querySelector(".product__images--thumbnail");w.addEventListener("click",a=>{if("product__images--thumbnail"!=a.target.className){const b=a.target.style.backgroundImage;c.style.backgroundImage=b}})},!0)}}catch(a){showResultModal(!1,a.message)}}const modalContainer=document.querySelector(".modal"),closeModalIcon=document.getElementById("close-modal-icon"),openModalHandler=()=>{modalContainer.style.display="block",setTimeout(()=>{modalContainer.style.opacity=1},500);const a=document.getElementById("header-navigation");a.classList.contains("sideNav-open")&&a.classList.remove("sideNav-open")},closeModalHandler=()=>{modalContainer.style.opacity=0,setTimeout(()=>{itemsContainer.innerHTML="",modalContainer.style.display="none"},600)};closeModalIcon.addEventListener("click",closeModalHandler);const previewProduct=a=>{const b=document.getElementById("modal-current-category");b.textContent=a.charAt(0).toUpperCase()+a.slice(1),getProduct(a)};document.querySelector(".products__list").addEventListener("click",a=>{if("A"==a.target.tagName){let b=a.target.textContent.toLowerCase();b=b.replace(" ",""),openModalHandler(),previewProduct(b)}}),document.querySelector(".modal__categories").addEventListener("click",a=>{if("P"==a.target.tagName){let b=a.target.textContent.toLowerCase();b=b.replace(" ",""),previewProduct(b)}});const setActiveProduct=a=>{null!=localStorage.getItem("activeProduct")&&localStorage.removeItem("activeProduct"),localStorage.setItem("activeProduct",JSON.stringify(a))},SingleProductCloseIcon=document.querySelector(".single-product__close-button");SingleProductCloseIcon.addEventListener("click",()=>{singleItemContainer.classList.remove("single-product--open"),localStorage.removeItem("activeProduct")});const SingleProductFavoriteIcon=document.querySelector(".actions__favorite");SingleProductFavoriteIcon.addEventListener("click",()=>{const a=JSON.parse(localStorage.getItem("activeProduct"));addToFavorite(a)});const SingleProductChartIcon=document.querySelector(".actions__chart");SingleProductChartIcon.addEventListener("click",()=>{let a=document.querySelector(".actions__amount");a=parseInt(a.textContent);const b=JSON.parse(localStorage.getItem("activeProduct"));addToChart(b,a)});const addToFavorite=a=>{if(null==localStorage.getItem("favorite")){localStorage.setItem("favorite",JSON.stringify([]))}const b=JSON.parse(localStorage.getItem("favorite"));let c=!1;for(const d of b)a.category==d.category&&a.id==d.id&&(c=!0);c||(b.push(a),localStorage.setItem("favorite",JSON.stringify(b))),showResultModal(!0,"added to favorites")},removeFromFavorite=a=>{const b=JSON.parse(localStorage.getItem("favorite"));b.splice(a,1),localStorage.removeItem("favorite"),localStorage.setItem("favorite",JSON.stringify(b)),createFavorite(),showResultModal(!0,"removed from favorites")},createFavorite=()=>{if(null==localStorage.getItem("favorite")){localStorage.setItem("favorite",JSON.stringify([]))}const a=JSON.parse(localStorage.getItem("favorite")),b=document.querySelector(".right-menu__content");b.innerHTML="",a.forEach((a,c)=>{const d=a.category,e=a.id,f=a.image,g=a.price,h=a.title,i=a.count,j={...a},k=document.createElement("div");k.classList.add("content__item");const l=document.createElement("div");l.classList.add("item__image"),l.style.backgroundImage=f,k.appendChild(l);const m=document.createElement("div");m.classList.add("item__info");const n=document.createElement("p");n.classList.add("item__info--title"),n.textContent=h,m.appendChild(n);const o=document.createElement("p");o.classList.add("item__info--price");const p=document.createElement("span");p.setAttribute("id","price__number"),p.textContent=g,o.appendChild(p),m.appendChild(o),k.appendChild(m);const q=document.createElement("div");q.classList.add("item__remove");const r=document.createElement("i");r.classList.add("fas","fa-trash-alt");const s=document.createElement("i");s.classList.add("fas","fa-shopping-basket"),q.appendChild(r),q.appendChild(s),r.addEventListener("click",removeFromFavorite.bind(null,c)),s.addEventListener("click",addToChart.bind(null,j,1)),k.appendChild(q),b.appendChild(k)})},addToChart=(a,b=1)=>{if(null==localStorage.getItem("chart")){localStorage.setItem("chart",JSON.stringify([]))}const c=JSON.parse(localStorage.getItem("chart"));let d=!1;for(const e of c)a.category==e.category&&a.id==e.id&&(d=!0);d||(a.count!=parseInt(b)&&(a.count=parseInt(b)),c.push(a),localStorage.setItem("chart",JSON.stringify(c))),showResultModal(!0,"added to shopping chart")},removeFromChart=a=>{const b=JSON.parse(localStorage.getItem("chart"));b.splice(a,1),localStorage.removeItem("chart"),localStorage.setItem("chart",JSON.stringify(b)),createChart(),calculateChart(),showResultModal(!0,"removed from shopping chart")},createChart=()=>{if(null==localStorage.getItem("chart")){localStorage.setItem("chart",JSON.stringify([]))}const a=JSON.parse(localStorage.getItem("chart")),b=document.querySelector(".right-menu__content");b.innerHTML="",a.forEach((a,c)=>{const d=a.category,e=a.id,f=a.image,g=a.price,h=a.title,i=a.count,j=document.createElement("div");j.classList.add("content__item");const k=document.createElement("div");k.classList.add("item__image"),k.style.backgroundImage=f,j.appendChild(k);const l=document.createElement("div");l.classList.add("item__info");const m=document.createElement("p");m.classList.add("item__info--title"),m.textContent=h,l.appendChild(m);const n=document.createElement("p");n.classList.add("item__info--price");const o=document.createElement("span");o.setAttribute("id","price__count"),o.textContent=i,n.appendChild(o),n.innerHTML+=" x ";const p=document.createElement("span");p.setAttribute("id","price__number"),p.textContent=g,n.appendChild(p),l.appendChild(n),j.appendChild(l);const q=document.createElement("div");q.classList.add("item__remove");const r=document.createElement("i");r.classList.add("fas","fa-trash-alt"),q.appendChild(r),q.addEventListener("click",removeFromChart.bind(null,c)),j.appendChild(q),b.appendChild(j)})},calculateChart=()=>{if(null==localStorage.getItem("chart")){localStorage.setItem("chart",JSON.stringify([]))}const a=JSON.parse(localStorage.getItem("chart"));let b=0;for(const c of a){let a=c.price;a=a.substring(1),a=a.trim(),a=a.replace(",","."),a=parseFloat(a),b+=a*c.count}const c=document.getElementById("footer_total--sum");c.innerHTML="&euro; ",c.innerHTML+=b.toFixed(2)},closeRightMenuIcon=document.querySelector(".right-menu__header--close"),toggleRightMenu=()=>{const a=document.getElementById("header-navigation");a.classList.contains("sideNav-open")&&a.classList.remove("sideNav-open");const b=document.querySelector(".right-menu");b.classList.toggle("right-menu-toggle")};closeRightMenuIcon.addEventListener("click",toggleRightMenu);const openChartMenuIcon=document.getElementById("navigation__icons--chart");openChartMenuIcon.addEventListener("click",()=>{const a=document.querySelector(".right-menu__footer");a.classList.contains("right-menu__footer--close")&&a.classList.remove("right-menu__footer--close");const b=document.querySelector(".footer__checkout");b.textContent="",b.textContent="CHECK OUT",createChart(),calculateChart(),toggleRightMenu()});const openFavoriteMenuIcon1=document.getElementById("navigation__icons--favorite1"),openFavoriteMenuIcon2=document.getElementById("navigation__icons--favorite2");openFavoriteMenuIcon1.addEventListener("click",()=>{const a=document.querySelector(".right-menu__footer");a.classList.contains("right-menu__footer--close")||a.classList.add("right-menu__footer--close"),console.log("im first"),createFavorite(),toggleRightMenu()}),openFavoriteMenuIcon2.addEventListener("click",()=>{const a=document.querySelector(".right-menu__footer");a.classList.contains("right-menu__footer--close")||a.classList.add("right-menu__footer--close"),console.log("im second"),createFavorite(),toggleRightMenu()});const hamburgerIcon=document.querySelector(".menu-icon"),sideNavCloseIcon=document.querySelector(".navigation__close-button"),productList=document.getElementById("products-list"),productItems=document.getElementById("products-items"),toggleSideNavClass=()=>{const a=document.querySelector(".right-menu");a.classList.contains("right-menu-toggle")&&a.classList.remove("right-menu-toggle");const b=document.getElementById("header-navigation");b.classList.toggle("sideNav-open")};hamburgerIcon.addEventListener("click",toggleSideNavClass),sideNavCloseIcon.addEventListener("click",()=>{toggleSideNavClass(),productItems.classList.remove("products-open")}),productList.addEventListener("click",()=>{productItems.classList.toggle("products-open")});const homeButton=document.querySelector(".fa-home");homeButton.addEventListener("click",()=>{window.scrollTo(0,0)});const copyrightElement=document.getElementById("copyright"),currentYear=new Date().getFullYear().toString();copyrightElement.textContent=currentYear;let indexId=1;const changeSlideshow=setInterval(()=>{const a=[{url:"url('assets/images/01-slideshow.jpg')",text:"Chair"},{url:"url('assets/images/02-slideshow.jpg')",text:"Spring"},{url:"url('assets/images/03-slideshow.jpg')",text:"New"}],b=document.getElementById("slideshow-text"),c=document.getElementById("slideshow-container");3==indexId&&(indexId=0),c.style.backgroundImage=a[indexId].url,b.textContent=a[indexId].text,indexId++},5e3),openUserModal=()=>{if(null!=sessionStorage.getItem("user")){const a=JSON.parse(sessionStorage.getItem("user"));if(a.status)return void showResultModal(!1,"you are already signed in")}const a=document.querySelector(".user");a.classList.toggle("user-show"),UserSignupModal.style.display="none",showUserLoginModal()},toggleUserModal=()=>{const a=document.querySelector(".user");a.classList.toggle("user-show"),UserSignupModal.style.display="none",showUserLoginModal()},closeUserModalIcon=document.getElementById("close-user");closeUserModalIcon.addEventListener("click",toggleUserModal);const topUserModalIcon=document.getElementById("user-top-icon"),bottomUserModalIcon=document.getElementById("user-bottom-icon"),UserLoginModal=document.querySelector(".user__modal--login"),showUserLoginModal=()=>{UserLoginModal.style.display="flex"};topUserModalIcon.addEventListener("click",openUserModal),bottomUserModalIcon.addEventListener("click",openUserModal);const showUserSignupButton=document.querySelector(".login__button--register"),UserSignupModal=document.querySelector(".user__modal--signup");showUserSignupButton.addEventListener("click",()=>{UserLoginModal.style.display="none",UserSignupModal.style.display="flex"});const loginForm=document.getElementById("login-form"),loginUserName=document.getElementById("login__username"),loginPassword=document.getElementById("login__password");let loginError=!1;const validateLoginUsername=()=>{const a=loginUserName.value.trim();""==a?(loginUserName.style.borderColor="red",document.getElementById("login-username-error").textContent="username field is empty!",loginError=!0):null==a.match(/^[a-zA-Z0-9]+$/)?(loginUserName.style.borderColor="red",document.getElementById("login-username-error").textContent="username is not valid!",loginError=!0):(loginUserName.style.borderColor="green",document.getElementById("login-username-error").textContent="")},validateLoginPassword=()=>{const a=loginPassword.value.trim();""==a?(loginPassword.style.borderColor="red",document.getElementById("login-password-error").textContent="password field is empty!",loginError=!0):(loginPassword.style.borderColor="green",document.getElementById("login-password-error").textContent="")};loginForm.addEventListener("submit",a=>{if(a.preventDefault(),validateLoginUsername(),validateLoginPassword(),!loginError){const a={username:loginUserName.value.trim(),password:loginPassword.value.trim()};try{sendUserInfo("POST","http://localhost/api/user/login.php",a).then(a=>{if("success"==a.status){toggleUserModal(),showResultModal(!0,"user logged in successfully");const b={userName:a.username,status:!0};sessionStorage.setItem("user",JSON.stringify(b))}else showResultModal(!1,a.status)}).catch(a=>{showResultModal(!1,a)})}catch(a){showResultModal(!1,a.message)}}});const sendUserInfo=(a,b,c)=>fetch(b,{method:a,body:JSON.stringify(c),headers:{"Content-Type":"application/json"}}).then(a=>200<=a.status&&300>a.status?a.json():a.json().then(a=>{throw showResultModal(!1,a),new Error("Server-side problem!")})).catch(a=>{throw console.log("im here"),showResultModal(!1,a),new Error("Something went wrong!")}),signupForm=document.getElementById("signup-form"),firstName=document.getElementById("signup__firstname"),lastName=document.getElementById("signup__lastname"),email=document.getElementById("signup__email"),signupUserName=document.getElementById("signup__username"),signupPassword=document.getElementById("signup__password");let signupError=!1;const validateFirstName=()=>{const a=firstName.value.trim();""==a?(firstName.style.borderColor="red",document.getElementById("firstname-error").textContent="first name field is empty!",signupError=!0):null==a.match(/^[a-zA-Z ]+$/)?(firstName.style.borderColor="red",document.getElementById("firstname-error").textContent="first name is not valid!",signupError=!0):(firstName.style.borderColor="green",document.getElementById("firstname-error").textContent="")},validateLastName=()=>{const a=lastName.value.trim();""==a?(lastName.style.borderColor="red",document.getElementById("lastname-error").textContent="last name field is empty!",signupError=!0):null==a.match(/^[a-zA-Z ]+$/)?(lastName.style.borderColor="red",document.getElementById("lastname-error").textContent="last name is not valid!",signupError=!0):(lastName.style.borderColor="green",document.getElementById("lastname-error").textContent="")},validateEmail=()=>{const a=email.value.trim();""==a?(email.style.borderColor="red",document.getElementById("email-error").textContent="email field is empty!",signupError=!0):null==a.match(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/)?(email.style.borderColor="red",document.getElementById("email-error").textContent="email is not valid!",signupError=!0):(email.style.borderColor="green",document.getElementById("email-error").textContent="")},validateRegisterUsername=()=>{const a=signupUserName.value.trim();""==a?(signupUserName.style.borderColor="red",document.getElementById("signup-username-error").textContent="username field is empty!",signupError=!0):null==a.match(/^[a-zA-Z0-9]+$/)?(signupUserName.style.borderColor="red",document.getElementById("signup-username-error").textContent="username is not valid!",signupError=!0):(signupUserName.style.borderColor="green",document.getElementById("signup-username-error").textContent="")},validateRegisterPassword=()=>{const a=signupPassword.value.trim();""==a?(signupPassword.style.borderColor="red",document.getElementById("signup-password-error").textContent="password field is empty!",signupError=!0):(signupPassword.style.borderColor="green",document.getElementById("signup-password-error").textContent="")};signupForm.addEventListener("submit",a=>{if(a.preventDefault(),validateFirstName(),validateLastName(),validateEmail(),validateRegisterUsername(),validateRegisterPassword(),!signupError){const a={firstname:firstName.value.trim(),lastname:lastName.value.trim(),email:email.value.trim(),username:signupUserName.value.trim(),password:signupPassword.value.trim()};try{sendUserInfo("POST","http://localhost/api/user/register.php",a).then(a=>{"success"==a.status?(toggleUserModal(),showResultModal(!0,"user is registered successfully")):showResultModal(!1,a.status)}).catch(a=>{showResultModal(!1,a)})}catch(a){showResultModal(!1,a.message)}}});